{"version":3,"sources":["utils/metamask-connect.js","store/types.js","store/actions.js","store/operations.js","store/reducer.js","contexts/Application.jsx","components/Header.jsx","components/Web3Status.jsx","components/Purses.jsx","components/Inbox.jsx","components/Wallet.jsx","pages/App.jsx","index.jsx"],"names":["index","pluginApi","a","ethereum","alert","console","log","origin","URL","toString","pluginOrigin","send","method","params","result","error","requestIndex","getPluginApi","date","walletAcceptOffer","walletDeclineOffer","doFetch","req","fetch","body","JSON","stringify","headers","then","response","json","ok","res","catch","err","onConnect","onDisconnect","onMessage","data","reason","activateWebSocket","createWeb3Socket","activateConnection","type","deactivateConnection","serverConnected","serverDisconnected","updatePurses","payload","updateInbox","declineOffer","acceptOffer","state","logInAndInstall","active","reducer","connected","purses","inbox","TypeError","ApplicationContext","createContext","useApplicationContext","useContext","useStyles","makeStyles","theme","appBar","position","title","flexGrow","icon","marginRight","spacing","Header","children","classes","AppBar","className","Toolbar","Typography","variant","color","noWrap","divider","Web3Status","dispatch","account","Chip","label","avatar","Button","onClick","minWidth","Purses","Array","isArray","length","List","map","purseName","assayId","allegedName","extent","ListItem","key","value","ListItemIcon","ListItemText","primary","secondary","margin","buttons","marginLeft","RedIconButton","withStyles","root","palette","getContrastText","red","backgroundColor","IconButton","GreenIconButton","green","RedChip","width","borderColor","GreenChip","Inbox","instanceId","purseName0","purseName1","assayId0","assayId1","extent0","extent1","status","edge","Grid","container","direction","item","display","Date","toLocaleDateString","year","month","day","hour","minute","second","formatDate","Box","component","fontWeight","ListItemSecondaryAction","size","aria-label","handleDecline","handleAccept","paper","marginTop","marginBottom","padding","breakpoints","up","aside","borderRightColor","borderRightStyle","borderRightWidth","Wallet","Paper","align","xs","layout","createMuiTheme","main","typography","useNextVariants","render","useReducer","useEffect","messageHandler","message","parse","Provider","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.d495cc4c.chunk.js","sourcesContent":["/* globals ethereum, fetch */\n\n// todo: refactor this to a class\n\nlet index, pluginApi\n\n// === FETCH\nexport async function logInAndInstall () {\n  if (typeof ethereum === 'undefined') { // eslint-disable-line no-undef\n    alert('Please install MetaMask from metamask.io')\n    return\n  }\n  console.log('logging in to metamask')\n  const origin = new URL('package.json', 'http://localhost:8090').toString()\n  const pluginOrigin = `wallet_plugin_${origin}`\n  const result = await ethereum.send({ // eslint-disable-line no-undef\n    method: 'wallet_requestPermissions',\n    params: [{\n      [pluginOrigin]: {}\n    }]\n  })\n\n  return result.result && !result.error\n}\n\nexport async function requestIndex () {\n  console.log('requesting index')\n  if (typeof ethereum === 'undefined') { // eslint-disable-line no-undef\n    alert('Please install MetaMask from metamask.io')\n    return\n  }\n\n  try {\n    if (!index) {\n      index = await ethereum.requestIndex() // eslint-disable-line no-undef\n    }\n    console.log('now we try to get that plugin API')\n    if (!pluginApi) {\n      pluginApi = await index.getPluginApi('http://localhost:8090/package.json')\n      console.log('oh boyo we did!', pluginApi)\n    }\n  } catch (e) {\n    console.error('Problem loading plugin api', e)\n  }\n  return pluginApi\n}\n\nexport async function walletAcceptOffer (date) {\n  if (!pluginApi) {\n    await requestIndex()\n  }\n  pluginApi.walletAcceptOffer(date)\n}\n\nexport async function walletAddOffer (offer) {\n  if (!pluginApi) {\n    await requestIndex()\n  }\n  pluginApi.walletAddOffer(offer)\n}\n\nexport async function walletGetPurses () {\n  console.log('walletGetPurses called')\n  if (!pluginApi) {\n    await requestIndex()\n  }\n  return pluginApi.walletGetPurses()\n}\n\nexport async function walletDeclineOffer (date) {\n  if (!pluginApi) {\n    await requestIndex()\n  }\n  pluginApi.walletDeclineOffer(date)\n}\n\nexport async function doFetch(req) {\n  return fetch('/vat', {\n    method: 'POST',\n    body: JSON.stringify(req),\n    headers: { 'Content-Type': 'application/json' },\n  })\n    .then(response => response.json())\n    .then(({ ok, res }) => (ok ? res : {}))\n    .catch(err => {\n      console.log('Fetch Error', err);\n    });\n}\n\n// === WEB SOCKET\n\nexport async function createWeb3Socket({ onConnect, onDisconnect, onMessage }) {\n  await requestIndex()\n  if (pluginApi) {\n    console.log('registering message handler on pluginApi')\n    pluginApi.onMessage((data) => {\n      console.log('received data from plugin', data)\n      onMessage(data)\n\n    })\n    .catch((reason) => {\n      console.error(`issue registering listener`, reason)\n    })\n    .then(() => {\n      console.log('we really did register that listener. plugin said so.')\n    })\n  }\n}\n\nfunction closeWebSocket() {\n}\n\nfunction isWebSocketActive() {\n  return true\n}\n\nexport function activateWebSocket(websocketListeners = {}) {\n  createWeb3Socket(websocketListeners);\n}\n\nexport function deactivateWebSocket() {\n  closeWebSocket();\n}\n","export const ACTIVATE_CONNECTION = 'ACTIVATE_CONNECTION';\nexport const DEACTIVATE_CONNECTION = 'DEACTIVATE_CONNECTION';\n\nexport const SERVER_CONNECTED = 'SERVER_CONNECTED';\nexport const SERVER_DISCONNECTED = 'SERVER_DISCONNECTED';\n\nexport const UPDATE_PURSES = 'UPDATE_PURSES';\nexport const UPDATE_INBOX = 'UPDATE_INBOX';\n\nexport const REJECT_OFFER = 'REJECT_OFFER';\nexport const CONFIRM_OFFER = 'CONFIRM_OFFER';\n","import {\n  ACTIVATE_CONNECTION,\n  DEACTIVATE_CONNECTION,\n  SERVER_CONNECTED,\n  SERVER_DISCONNECTED,\n  UPDATE_PURSES,\n  UPDATE_INBOX,\n  REJECT_OFFER,\n  CONFIRM_OFFER,\n} from './types';\n\nexport const activateConnection = () => ({\n  type: ACTIVATE_CONNECTION,\n});\n\nexport const deactivateConnection = () => ({\n  type: DEACTIVATE_CONNECTION,\n});\n\nexport const serverConnected = () => ({\n  type: SERVER_CONNECTED,\n});\n\nexport const serverDisconnected = () => ({\n  type: SERVER_DISCONNECTED,\n});\n\nexport const updatePurses = payload => ({\n  type: UPDATE_PURSES,\n  payload,\n});\nexport const updateInbox = payload => ({\n  type: UPDATE_INBOX,\n  payload,\n});\n\nexport const declineOffer = payload => ({\n  type: REJECT_OFFER,\n  payload,\n});\nexport const acceptOffer = payload => ({\n  type: CONFIRM_OFFER,\n  payload,\n});\n","import { logInAndInstall, requestIndex,\n  walletAcceptOffer, walletDeclineOffer } from '../utils/metamask-connect';\n\nexport function activateConnection(state) {\n  logInAndInstall()\n  .then(requestIndex)\n  .catch((reason) => {\n    console.error(`Problem installing plugin`, reason)\n  })\n  return { ...state, active: true };\n}\n\nexport function deactivateConnection(state) {\n  return { ...state, active: false };\n}\n\nexport function serverConnected(state) {\n  return { ...state, connected: true };\n}\nexport function serverDisconnected(state) {\n  return { ...state, connected: false };\n}\n\nexport function updatePurses(state, purses) {\n  return { ...state, purses };\n}\nexport function updateInbox(state, inbox) {\n  return { ...state, inbox };\n}\n\nexport function declineOffer(state, date) {\n  walletDeclineOffer(date)\n  .catch((reason) => {\n    console.error(`Problem declining offer`, reason)\n  })\n  return state;\n}\nexport function acceptOffer(state, date) {\n  walletAcceptOffer(date)\n  .catch((reason) => {\n    console.error(`Problem accepting offer`, reason)\n  })\n  return state;\n}\n","import {\n  ACTIVATE_CONNECTION,\n  DEACTIVATE_CONNECTION,\n  SERVER_CONNECTED,\n  SERVER_DISCONNECTED,\n  UPDATE_PURSES,\n  UPDATE_INBOX,\n  REJECT_OFFER,\n  CONFIRM_OFFER,\n} from './types';\nimport {\n  activateConnection,\n  deactivateConnection,\n  serverConnected,\n  serverDisconnected,\n  updatePurses,\n  updateInbox,\n  declineOffer,\n  acceptOffer,\n} from './operations';\n\nexport function createDefaultState() {\n  return {\n    active: false,\n    connected: false,\n    account: null,\n    purses: null,\n    inbox: null,\n  };\n}\n\nexport const reducer = (state, { type, payload }) => {\n  switch (type) {\n    case ACTIVATE_CONNECTION:\n      return activateConnection(state);\n    case DEACTIVATE_CONNECTION:\n      return deactivateConnection(state);\n\n    case SERVER_CONNECTED:\n      return serverConnected(state);\n    case SERVER_DISCONNECTED:\n      return serverDisconnected(state);\n\n    case UPDATE_PURSES:\n      return updatePurses(state, payload);\n    case UPDATE_INBOX:\n      return updateInbox(state, payload);\n\n    case REJECT_OFFER:\n      return declineOffer(state, payload);\n    case CONFIRM_OFFER:\n      return acceptOffer(state, payload);\n\n    default:\n      throw new TypeError(`Action not supported ${type}`);\n  }\n};\n","import React, { createContext, useContext, useReducer, useEffect } from 'react';\n\nimport {\n  activateWebSocket,\n  deactivateWebSocket,\n  doFetch,\n} from '../utils/metamask-connect';\n\n\n\nimport {\n  updatePurses,\n  updateInbox,\n  serverConnected,\n  serverDisconnected,\n  deactivateConnection,\n} from '../store/actions';\nimport { reducer, createDefaultState } from '../store/reducer';\n\nexport const ApplicationContext = createContext();\n\nexport function useApplicationContext() {\n  return useContext(ApplicationContext);\n}\n\nexport default function Provider({ children }) {\n  const [state, dispatch] = useReducer(reducer, createDefaultState());\n  const { active } = state;\n\n  useEffect(() => {\n    function messageHandler(message) {\n      if (!message) return;\n      const { type, data } = message;\n      if (type === 'walletUpdatePurses') {\n        console.log('updating those purses')\n        dispatch(updatePurses(JSON.parse(data)));\n      }\n      if (type === 'walletUpdateInbox') {\n        console.log('updating that wlalet')\n        dispatch(updateInbox(JSON.parse(data)));\n      }\n    }\n\n    function walletGetPurses() {\n      return doFetch({ type: 'walletGetPurses' }).then(messageHandler);\n    }\n    function walletGetInbox() {\n      return doFetch({ type: 'walletGetInbox' }).then(messageHandler);\n    }\n\n    if (true || active) {\n      activateWebSocket({\n        onConnect() {\n          dispatch(serverConnected());\n          walletGetPurses();\n          walletGetInbox();\n        },\n        onDisconnect() {\n          dispatch(serverDisconnected());\n          dispatch(deactivateConnection());\n          dispatch(updatePurses(null));\n          dispatch(updateInbox(null));\n        },\n        onMessage(message) {\n          console.log('received data from plugin!', message)\n          messageHandler(message);\n        },\n      });\n    } else {\n      deactivateWebSocket();\n    }\n  }, [active]);\n\n  return (\n    <ApplicationContext.Provider value={{ state, dispatch }}>\n      {children}\n    </ApplicationContext.Provider>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, Typography } from '@material-ui/core';\nimport WalletIcon from '@material-ui/icons/AccountBalanceWallet';\n\nconst useStyles = makeStyles(theme => ({\n  appBar: {\n    position: 'relative',\n  },\n  title: {\n    flexGrow: 1,\n  },\n  icon: {\n    marginRight: theme.spacing(1),\n  },\n}));\n\nexport default function Header({ children }) {\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"absolute\" className={classes.appBar}>\n      <Toolbar>\n        <WalletIcon className={classes.icon} />\n        <Typography\n          variant=\"h6\"\n          color=\"inherit\"\n          noWrap\n          className={classes.title}\n        >\n          Simple Wallet\n        </Typography>\n        {children}\n      </Toolbar>\n    </AppBar>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Button, Chip } from '@material-ui/core';\nimport PersonIcon from '@material-ui/icons/Person';\n\nimport { useApplicationContext } from '../contexts/Application';\nimport { activateConnection, deactivateConnection } from '../store/actions';\n\nconst useStyles = makeStyles(theme => ({\n  divider: {\n    marginRight: theme.spacing(2),\n  },\n}));\n\nexport default function Web3Status() {\n  const classes = useStyles();\n  const { state, dispatch } = useApplicationContext();\n  const { active, connected, account } = state;\n\n  function handleConnect() {\n    dispatch(activateConnection());\n  }\n\n  function handleDisconnect() {\n    dispatch(deactivateConnection());\n  }\n\n  return (\n    <>\n      {connected && (\n        <Chip\n          className={classes.divider}\n          label={account || 'anonymous'}\n          avatar={<PersonIcon />}\n        />\n      )}\n      {active ? (\n        <Button variant=\"contained\" onClick={handleDisconnect}>\n          Disconnect\n        </Button>\n      ) : (\n        <Button variant=\"contained\" onClick={handleConnect}>\n          Connect\n        </Button>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n  List,\n  ListItemIcon,\n  ListItem,\n  ListItemText,\n  Typography,\n} from '@material-ui/core';\nimport PurseIcon from '@material-ui/icons/BusinessCenter';\n\nimport { useApplicationContext } from '../contexts/Application';\n\nconst useStyles = makeStyles(theme => ({\n  icon: {\n    minWidth: 24,\n    marginRight: theme.spacing(2),\n  },\n}));\n\nexport default function Purses() {\n  const classes = useStyles();\n  const { state } = useApplicationContext();\n  const { purses } = state;\n\n  return (\n    <>\n      <Typography variant=\"h6\">Purses</Typography>\n      {Array.isArray(purses) && purses.length > 0 ? (\n        <List>\n          {purses.map(({ purseName, assayId, allegedName, extent }) => (\n            <ListItem key={purseName} value={purseName} divider>\n              <ListItemIcon className={classes.icon}>\n                <PurseIcon />\n              </ListItemIcon>\n              <ListItemText\n                primary={purseName}\n                secondary={`${extent} ${assayId} (${allegedName})`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      ) : (\n        <Typography color=\"inherit\">No purses.</Typography>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport { green, red } from '@material-ui/core/colors';\nimport {\n  Box,\n  Chip,\n  Grid,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemSecondaryAction,\n  IconButton,\n  Typography,\n} from '@material-ui/core';\nimport AutoswapIcon from '@material-ui/icons/SwapHorizontalCircle';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport CheckIcon from '@material-ui/icons/Check';\n\nimport { useApplicationContext } from '../contexts/Application';\n\nimport { declineOffer, acceptOffer } from '../store/actions';\n\nconst useStyles = makeStyles(theme => ({\n  icon: {\n    margin: theme.spacing(1),\n  },\n  buttons: {\n    '& button ~ button': {\n      marginLeft: theme.spacing(1),\n    },\n  },\n}));\n\nconst RedIconButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(red[500]),\n    backgroundColor: red[500],\n    '&:hover': {\n      backgroundColor: red[700],\n    },\n  },\n}))(IconButton);\n\nconst GreenIconButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(green[500]),\n    backgroundColor: green[500],\n    '&:hover': {\n      backgroundColor: green[700],\n    },\n  },\n}))(IconButton);\n\nconst RedChip = withStyles(theme => ({\n  root: {\n    width: theme.spacing(10),\n    color: red[800],\n    borderColor: red[800],\n  },\n}))(Chip);\n\nconst GreenChip = withStyles(theme => ({\n  root: {\n    width: theme.spacing(10),\n    color: green[800],\n    borderColor: green[800],\n  },\n}))(Chip);\n\nexport default function Inbox() {\n  const classes = useStyles();\n  const { state, dispatch } = useApplicationContext();\n  const { inbox } = state;\n\n  function formatDate(date) {\n    const options = {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n    };\n    return new Date(date).toLocaleDateString('en-US', options);\n  }\n\n  function handleDecline(date) {\n    dispatch(declineOffer(date));\n  }\n\n  function handleAccept(date) {\n    dispatch(acceptOffer(date));\n  }\n\n  return (\n    <>\n      <Typography variant=\"h6\">Transactions</Typography>\n      {Array.isArray(inbox) && inbox.length > 0 ? (\n        <List>\n          {inbox.map(\n            ({\n              instanceId,\n              date,\n              purseName0,\n              purseName1,\n              assayId0,\n              assayId1,\n              extent0,\n              extent1,\n              status,\n            }) => (\n              <ListItem key={date} value={date} divider>\n                <ListItemIcon>\n                  <AutoswapIcon edge=\"start\" className={classes.icon} />\n                </ListItemIcon>\n                <Grid container direction=\"column\">\n                  <Grid item>\n                    <Typography variant=\"body2\" display=\"block\">\n                      {`${instanceId} - ${formatDate(date)}`}\n                    </Typography>\n                  </Grid>\n                  <Grid item>\n                    <Typography variant=\"body1\">\n                      Pay&nbsp;\n                      <Box component=\"span\" fontWeight={800}>\n                        {extent0}\n                        &nbsp;\n                        {assayId0}\n                        &nbsp;\n                      </Box>\n                      from&nbsp;\n                      {purseName0}\n                    </Typography>\n                    <Typography variant=\"body1\">\n                      to receive&nbsp;\n                      <Box component=\"span\" fontWeight={800}>\n                        {extent1}\n                        &nbsp;\n                        {assayId1}\n                        &nbsp;\n                      </Box>\n                      into&nbsp;\n                      {purseName1}\n                    </Typography>\n                  </Grid>\n                </Grid>\n                <ListItemSecondaryAction className={classes.buttons}>\n                  {status === 'decline' && <RedChip  variant=\"outlined\" label=\"Declined\" />}\n                  {status === 'accept' && <GreenChip  variant=\"outlined\" label=\"Accepted\" />}\n                  {!status && (\n                    <>\n                      <RedIconButton\n                        size=\"small\"\n                        aria-label=\"Decline\"\n                        onClick={() => handleDecline(date)}\n                      >\n                        <ClearIcon />\n                      </RedIconButton>\n                      <GreenIconButton\n                        size=\"small\"\n                        aria-label=\"Accept\"\n                        onClick={() => handleAccept(date)}\n                      >\n                        <CheckIcon />\n                      </GreenIconButton>\n                    </>\n                  )}\n                </ListItemSecondaryAction>\n              </ListItem>\n            ),\n          )}\n        </List>\n      ) : (\n        <Typography color=\"inherit\">No transactions.</Typography>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Grid, Paper, Typography } from '@material-ui/core';\n\nimport Purses from './Purses';\nimport Inbox from './Inbox';\n\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(3),\n    marginBottom: theme.spacing(3),\n    padding: theme.spacing(2),\n    [theme.breakpoints.up(600 + theme.spacing(3) * 2)]: {\n      marginTop: theme.spacing(6),\n      marginBottom: theme.spacing(6),\n      padding: theme.spacing(3),\n    },\n  },\n  title: {\n    padding: theme.spacing(0, 0, 4),\n  },\n  aside: {\n    borderRightColor: theme.palette.divider,\n    borderRightStyle: 'solid',\n    borderRightWidth: 1,\n  },\n}));\n\nexport default function Wallet() {\n  const classes = useStyles();\n\n  return (\n    <Paper className={classes.paper}>\n      <Typography\n        component=\"h1\"\n        variant=\"h4\"\n        align=\"center\"\n        className={classes.title}\n      >\n        Wallet\n      </Typography>\n\n      <Grid container spacing={2}>\n        <Grid item xs={4} className={classes.aside}>\n          <Purses />\n        </Grid>\n        <Grid item xs={8}>\n          <Inbox />\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { CssBaseline } from '@material-ui/core';\n\nimport Header from '../components/Header';\nimport Web3Status from '../components/Web3Status';\nimport Wallet from '../components/Wallet';\n\nconst useStyles = makeStyles(theme => ({\n  layout: {\n    width: 'auto',\n    marginLeft: theme.spacing(2),\n    marginRight: theme.spacing(2),\n    [theme.breakpoints.up(1000 + theme.spacing(2) * 2)]: {\n      width: 1000,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n    },\n  },\n}));\n\nexport default function App() {\n  const classes = useStyles();\n\n  return (\n    <>\n      <CssBaseline />\n      <Header>\n        <Web3Status />\n      </Header>\n      <main className={classes.layout}>\n        <Wallet />\n      </main>\n    </>\n  );\n}\n","/* globals document */\nimport React from 'react';\nimport { render } from 'react-dom';\n\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\n\nimport ApplicationContextProvider from './contexts/Application';\nimport App from './pages/App';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#AB2328',\n    },\n    secondary: {\n      main: '#508AA8',\n    },\n  },\n  typography: {\n    useNextVariants: true,\n  },\n});\n\nrender(\n  <ApplicationContextProvider>\n    <MuiThemeProvider theme={theme}>\n      <App />\n    </MuiThemeProvider>\n  </ApplicationContextProvider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}